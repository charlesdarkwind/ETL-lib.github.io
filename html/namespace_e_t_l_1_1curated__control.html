<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ETL Library: ETL.curated_control Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ETL Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_e_t_l.html">ETL</a></li><li class="navelem"><a class="el" href="namespace_e_t_l_1_1curated__control.html">curated_control</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ETL.curated_control Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aae348611b6f974ab831df16213adc41c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1curated__control.html#aae348611b6f974ab831df16213adc41c">select</a> (config, table)</td></tr>
<tr class="separator:aae348611b6f974ab831df16213adc41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fbf9593ca7b270d14acbca0828c258c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1curated__control.html#a9fbf9593ca7b270d14acbca0828c258c">update</a> (config, table)</td></tr>
<tr class="separator:a9fbf9593ca7b270d14acbca0828c258c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a418426161bc24299963e1f4e11f9e9b1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1curated__control.html#a418426161bc24299963e1f4e11f9e9b1">delete</a> (config, table)</td></tr>
<tr class="separator:a418426161bc24299963e1f4e11f9e9b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e6e9b37203e4af1fa05f1751af901b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1curated__control.html#a80e6e9b37203e4af1fa05f1751af901b">create_if_not_exists</a> (config)</td></tr>
<tr class="separator:a80e6e9b37203e4af1fa05f1751af901b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Functions to use the control table in wich is saved information about ingested curated-zone folders.

For an incremental loads or finding row-level updates between two points in time of a given table.

Table schema:
  (table_name STRING, last_version INT)

Example rows:
  MessagesLikes 1
  MessagesLikes 2
  Messages 1
  Messages 2
  Messages 3
  Groups  1

Typical incremental flow:
  1. read data from curated (current table state)
  2. look the control table for "table_name" and get the row with highest value of "version"
  3. read curated data from that point in time using the version from the control table
  4. substract (SQL except) that second df from the first one
  5. ingest/process the curated data
  6. if data was successfully processed, get the new "VERSION" from the table's metadata
  7. insert a row in the control table with (table_name, version)</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a80e6e9b37203e4af1fa05f1751af901b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80e6e9b37203e4af1fa05f1751af901b">&#9670;&nbsp;</a></span>create_if_not_exists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.curated_control.create_if_not_exists </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create control table if not exists.

Save delta tables versions.

Parameters
----------
config: Config
  Config instance
</pre> 
</div>
</div>
<a id="a418426161bc24299963e1f4e11f9e9b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a418426161bc24299963e1f4e11f9e9b1">&#9670;&nbsp;</a></span>delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.curated_control.delete </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parameters
----------
config: Config
  Config instance

table: str
</pre> 
</div>
</div>
<a id="aae348611b6f974ab831df16213adc41c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae348611b6f974ab831df16213adc41c">&#9670;&nbsp;</a></span>select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.curated_control.select </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get last known delta table version saved inside the trusted control table.

Get the version number metadata of the delta table that was last saved
in the trusted control table so a diff of all updates since then can be retrieved.

Parameters
----------
config: Config
  Config instance

table: str

Returns
-------
str or None
</pre> 
</div>
</div>
<a id="a9fbf9593ca7b270d14acbca0828c258c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fbf9593ca7b270d14acbca0828c258c">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.curated_control.update </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Update the control table by inserting the delta table version id.

Parameters
----------
config: Config
  Config instance

table: str
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
