<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ETL Library: ETL.raw_tables Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ETL Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_e_t_l.html">ETL</a></li><li class="navelem"><a class="el" href="namespace_e_t_l_1_1raw__tables.html">raw_tables</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ETL.raw_tables Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad790d0785e6678d7f46836c4d2c03f5c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1raw__tables.html#ad790d0785e6678d7f46836c4d2c03f5c">read</a> (config, table, incremental=False, **dataframe_reader_options)</td></tr>
<tr class="separator:ad790d0785e6678d7f46836c4d2c03f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1959c543f441ab24166e6062212712fc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1raw__tables.html#a1959c543f441ab24166e6062212712fc">get_table_file_paths</a> (config, table, incremental=False)</td></tr>
<tr class="separator:a1959c543f441ab24166e6062212712fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e1d8ece7ad4c5ee2cd7238702a745d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_e_t_l_1_1raw__tables.html#a64e1d8ece7ad4c5ee2cd7238702a745d">get_table_folder_paths</a> (config, table, incremental=False)</td></tr>
<tr class="separator:a64e1d8ece7ad4c5ee2cd7238702a745d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This module provides utility functions to select/read JSON data from the ingestion raw zone.

The names and structure of tables, folders and paths must conform to the library's standard convention:

- raw-zone -| - data_source - ...
            |
            |
            | - data_source - ...
            |
            |
            | - yammer -  |
                          |
                          | - ingestion_date -| - table_name
                          |                   | - table_name
                          |
                          | - ingestion_date -| - table_name
                          |                   | - table_name
                          |
                          | - ingestion_date -| - table_name
                          |
                          |
                          | - inc-2019-12-31 -| - Users
                          |                   | - Messages
                          |
                          | - inc-2020-01-01 -| - Messages
                                              | - Groups


Data cannot be deleted/updated.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1959c543f441ab24166e6062212712fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1959c543f441ab24166e6062212712fc">&#9670;&nbsp;</a></span>get_table_file_paths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.raw_tables.get_table_file_paths </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>incremental</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get all absolute paths of files with data for the provided table name across all incremental folders.

Also returns short paths ready to update the raw control table.

Return format:

( [table_file_paths, ...], [control_table_updates, ....] )

(
  [
    '/dbfs/raw_mount/data_source/ingestion_date/table_name/some_file.json',
    '/dbfs/raw_mount/data_source/ingestion_date/table_name/some_file.json',
    '/dbfs/raw_mount/data_source/ingestion_date/table_name/some_file.json'
  ],
  [
    'inc-2019_09_08/table_name',
    'inc-2019_12_12/table_name'
  ]
)

Parameters
----------
config: Config
table
incremental

Returns
-------
(list of str, list of str)
</pre> 
</div>
</div>
<a id="a64e1d8ece7ad4c5ee2cd7238702a745d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e1d8ece7ad4c5ee2cd7238702a745d">&#9670;&nbsp;</a></span>get_table_folder_paths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.raw_tables.get_table_folder_paths </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>incremental</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get all absolute paths of folders with data for the provided table name across all incremental folders.

Also returns short paths ready to update the raw control table.
Batching paths discovery by folders may also reduce chances of timeout.

Return format:

( [table_folder_paths, ...], [control_table_updates, ....] )

(
  [
    '/dbfs/raw_mount/data_source/inc-2019_09_08/table_name',
    '/dbfs/raw_mount/data_source/inc-2019_12_12/table_name
  ],
  [
    'inc-2019_09_08/table_name',
    'inc-2019_12_12/table_name'
  ]
)

Parameters
----------
config: Config
table
incremental

Returns
-------
(list of str, list of str)
</pre> 
</div>
</div>
<a id="ad790d0785e6678d7f46836c4d2c03f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad790d0785e6678d7f46836c4d2c03f5c">&#9670;&nbsp;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def ETL.raw_tables.read </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>incremental</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>dataframe_reader_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parameters
----------
config: Config
table
incremental

Returns
-------
(pyspark.sql.DataFrame, list)
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
